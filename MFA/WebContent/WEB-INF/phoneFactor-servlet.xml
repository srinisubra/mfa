
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
	xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="
        http://www.springframework.org/schema/beans 
        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context-3.0.xsd">

	<bean id="phoneFactorAuthenticator" class="edu.gatech.mfa.extn.phonefactor.PhoneFactorAuthenticator"
		init-method="init">
		<property name="certificatePath" value="C:/Temp/config/"></property>
		<property name="privateKey" value="L164H8X4C4U2HZEJ"></property>
	</bean>

	<bean id="parameterExtractor" class="edu.gatech.mfa.test.MockPhoneFactorRequestExtractor"></bean>
	<bean id="dataSource" class="edu.gatech.mfa.test.MockDataSource"></bean>
	<bean id="successController" class="edu.gatech.mfa.test.MockSuccessController"></bean>
	<bean id="failureController" class="edu.gatech.mfa.test.MockFailureController"></bean>
	<bean id="checkUsernameFailedHandler" class="edu.gatech.mfa.core.InvalidUsernameActionHandler"></bean>

	<bean id="phoneFactorMFAExtension" class="edu.gatech.mfa.extn.phonefactor.PhoneFactorMFAExtension"
		init-method="init">
		<property name="authPageTemplate" value="phoneFactor-authenticate.vm"></property>
		<property name="phoneFactorAuthenticator" ref="phoneFactorAuthenticator"></property>
		<property name="name" value="Phone Factor"></property>
		<property name="requestParameterExtractor" ref="parameterExtractor"></property>
	</bean>

	<bean id="mfaConfiguration" class="edu.gatech.mfa.core.MFAConfiguration">
		<property name="dataSource" ref="dbDataSource"></property>
		<property name="failureController" ref="failureController"></property>
		<property name="successController" ref="successController"></property>
		<property name="extension" ref="phoneFactorMFAExtension"></property>
	</bean>

	<bean id="authController" class="edu.gatech.mfa.controller.MFAAuthController"
		init-method="init">
		<property name="mfaConfiguration" ref="mfaConfiguration"></property>
	</bean>

	<bean id="frontController" class="edu.gatech.mfa.controller.MFAFrontController"
		init-method="init">
		<property name="mfaConfiguration" ref="mfaConfiguration"></property>
		<property name="onFailure" ref="checkUsernameFailedHandler"></property>
		<property name="velocityFactory" ref="velocityFactory"></property>
	</bean>

	<bean id="requestInterceptor" class="edu.gatech.mfa.interceptor.RestrictedAccessInterceptor">
		<property name="redirectURLInCaseOfRestrictedAccess" value="../login1.html"></property>
	</bean>

	<bean id="urlMappings"
		class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
		
		<property name="mappings">
			<props>
				<prop key="checkUser">frontController</prop>
				<prop key="mfaAuth">authController</prop>
			</props>
		</property>
	</bean>
	
	<bean id="userController" class="edu.gatech.mfa.test.MockUserController" ></bean>
	
	<bean id="userDefinedUrlMappings"
		class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
		<property name="interceptors">
			<list>
				<ref bean="requestInterceptor"/>
			</list>
		</property>
		<property name="mappings">
			<props>
				<prop key="home.app">userController</prop>
			</props>
		</property>
	</bean>

	

	
	<!-- Velocity settings -->

	<bean id="velocityFactory" class="edu.gatech.mfa.core.VelocityFactory"
		init-method="init">
		<property name="props">
			<props>
				<prop key="resource.loader">class</prop>
				<prop key="class.resource.loader.class">org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader
				</prop>
			</props>
		</property>
	</bean>
<!-- Database settings -->
	<bean id="basicDataSource" class="org.apache.commons.dbcp.BasicDataSource">
		<property name="url" value="jdbc:mysql://localhost:3306/webinfs"></property>
		<property name="username" value="root"></property>
		<property name="password" value=""></property>
		<property name="driverClassName" value="com.mysql.jdbc.Driver"></property>
	</bean>

	<bean id="dbDataSource" class="edu.gatech.mfa.test.DbDataSource" init-method="init">
		<property name="dataSource" ref="basicDataSource"></property>
	</bean>
</beans>